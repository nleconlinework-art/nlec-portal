<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Admission Form | NLEC India</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background-color: #f4f7f6; padding: 20px; }
        .form-wrapper { max-width: 950px; margin: 0 auto; background: white; padding: 30px; border-radius: 15px; box-shadow: 0 5px 25px rgba(0,0,0,0.15); border-top: 8px solid #003366; }
        
        /* Institute Header */
        .inst-header { text-align: center; border-bottom: 2px solid #ff6600; padding-bottom: 15px; margin-bottom: 25px; }
        .inst-header h1 { color: #d32f2f; font-size: 32px; text-transform: uppercase; margin-bottom: 5px; }
        .inst-header p { font-size: 13px; font-weight: bold; color: #003366; line-height: 1.4; }

        h3 { background: #003366; color: white; padding: 10px 15px; font-size: 16px; margin: 25px 0 15px 0; border-radius: 5px; text-transform: uppercase; }
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; font-weight: bold; margin-bottom: 5px; font-size: 14px; color: #444; }
        input, select, textarea { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 5px; font-size: 14px; background: #fff; }
        
        /* Upload & Preview */
        .upload-box { border: 1px solid #ddd; padding: 15px; border-radius: 8px; background: #fafafa; text-align: center; }
        .preview-img { width: 100px; height: 120px; border: 1px solid #ddd; margin-top: 10px; display: none; object-fit: cover; margin-left: auto; margin-right: auto; }
        .preview-sign { width: 150px; height: 50px; border: 1px solid #ddd; margin-top: 10px; display: none; object-fit: contain; margin-left: auto; margin-right: auto; }

        .btn-submit { background: #d32f2f; color: white; padding: 18px; border: none; border-radius: 8px; width: 100%; font-weight: bold; cursor: pointer; font-size: 18px; transition: 0.3s; margin-top: 20px; }
        .btn-submit:hover { background: #003366; }

        /* Application Print Design */
        #printArea { display: none; padding: 40px; border: 2px solid #003366; position: relative; background: white; }
        .print-photo { position: absolute; top: 40px; right: 40px; width: 120px; height: 140px; border: 1px solid #000; }

        @media print {
            .form-wrapper, .btn-print-hide { display: none !important; }
            #printArea { display: block !important; }
        }
    </style>
</head>
<body>

<div class="form-wrapper" id="mainForm">
    <div class="inst-header">
        <h1>Next Level Educational Council</h1>
        <p>(An Autonomous Body Registered under Govt. of India)</p>
        <p>MCA Reg. No: U80902UP2022NPL173638 | MSME & Niti Aayog Regd. | ISO 9001:2015 Certified</p>
    </div>

    <h2 style="text-align:center; color:#333; margin-bottom:20px;">ONLINE ADMISSION FORM - 2026</h2>

    <form id="admissionForm">
        <h3>1. Personal Details (व्यक्तिगत जानकारी)</h3>
        <div class="form-grid">
            <div class="form-group"><label>Candidate Name</label><input type="text" id="sName" required></div>
            <div class="form-group"><label>Father's Name</label><input type="text" id="fName" required></div>
            <div class="form-group"><label>Mother's Name</label><input type="text" id="mName" required></div>
            <div class="form-group"><label>Date of Birth</label><input type="date" id="dob" required></div>
            <div class="form-group"><label>Mobile No.</label><input type="tel" id="mobile" maxlength="10" required></div>
            <div class="form-group"><label>WhatsApp No.</label><input type="tel" id="whatsapp" maxlength="10"></div>
        </div>

        <h3>2. Education & Course (शिक्षा और कोर्स)</h3>
        <div class="form-grid">
            <div class="form-group">
                <label>Highest Qualification</label>
                <select id="qual"><option>10th</option><option>12th</option><option>Graduate</option></select>
            </div>
            <div class="form-group">
                <label>Choose Course</label>
                <select id="course">
                    <option>ADCA (12 Months)</option>
                    <option>DCA (6 Months)</option>
                    <option>Tally Prime</option>
                </select>
            </div>
        </div>

        <h3>3. Upload Documents (दस्तावेज़ अपलोड करें)</h3>
        <div class="form-grid">
            <div class="upload-box">
                <label>Passport Photo (JPG)</label>
                <input type="file" id="photoInput" accept="image/*" onchange="preview(this, 'pPrev')" required>
                <img id="pPrev" class="preview-img">
            </div>
            <div class="upload-box">
                <label>Signature (JPG)</label>
                <input type="file" id="signInput" accept="image/*" onchange="preview(this, 'sPrev')" required>
                <img id="sPrev" class="preview-sign">
            </div>
            <div class="upload-box">
                <label>Aadhar Card (PDF)</label>
                <input type="file" id="aadharInput" accept=".pdf" required>
            </div>
            <div class="upload-box">
                <label>Marksheet (PDF)</label>
                <input type="file" id="markInput" accept=".pdf" required>
            </div>
        </div>

        <button type="button" class="btn-submit" id="submitBtn" onclick="processForm()">SUBMIT & GENERATE APPLICATION</button>
    </form>
</div>

<div id="printArea">
    <div class="inst-header">
        <h1>Next Level Educational Council</h1>
        <p>Registration No: MCA-U80902UP2022NPL173638</p>
    </div>
    <h2 style="text-align:center; text-decoration:underline;">APPLICATION FOR ADMISSION</h2>
    <img id="finalPhoto" class="print-photo">
    
    <div style="margin-top:40px; line-height:2.2; font-size:18px;">
        <p><b>Application ID:</b> NLEC/2026/<span id="pID"></span></p>
        <p><b>Student Name:</b> <span id="pName"></span></p>
        <p><b>Father's Name:</b> <span id="pfName"></span></p>
        <p><b>Course Applied:</b> <span id="pCourse"></span></p>
        <p><b>Contact No:</b> <span id="pMobile"></span></p>
    </div>
    
    <div style="margin-top:100px; display:flex; justify-content:space-between;">
        <div style="text-align:center;"><img id="finalSign" style="width:120px;"><br><b>Student Signature</b></div>
        <div style="text-align:center;"><br><br><b>Director Signature</b></div>
    </div>
    <br>
    <button class="btn-print-hide" onclick="window.print()" style="padding:10px 20px; cursor:pointer; background:#003366; color:white; border:none; margin-top:20px;">PRINT FORM</button>
</div>

<script>
    // यहाँ अपना नया Web App URL पेस्ट करें
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwdq_tg83Op3gf0HBPumFADDHZSg2-LJiaMkS-sUGLAnWSDSNgu-SyvMPEss756kcQG/exec";

    function preview(input, id) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById(id).src = e.target.result;
                document.getElementById(id).style.display = 'block';
            }
            reader.readAsDataURL(input.files[0]);
        }
    }

    async function processForm() {
        const btn = document.getElementById('submitBtn');
        const name = document.getElementById('sName').value;
        const mobile = document.getElementById('mobile').value;
        
        if(!name || !mobile) { 
            alert("Please fill all required details!"); 
            return; 
        }

        btn.innerText = "Processing... Data saving to Server";
        btn.disabled = true;

        const toBase64 = file => new Promise((resolve, reject) => {
            if(!file) { resolve(null); return; }
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = () => resolve({
                base64: reader.result.split(',')[1],
                type: file.type,
                name: file.name
            });
            reader.onerror = error => reject(error);
        });

        try {
            const payload = {
                StudentName: name,
                FatherName: document.getElementById('fName').value,
                Mobile: mobile,
                Course: document.getElementById('course').value,
                Photo: await toBase64(document.getElementById('photoInput').files[0]),
                Sign: await toBase64(document.getElementById('signInput').files[0]),
                Aadhar: await toBase64(document.getElementById('aadharInput').files[0]),
                Marksheet: await toBase64(document.getElementById('markInput').files[0])
            };

            // डेटा को Google Script पर भेजना
            const response = await fetch(SCRIPT_URL, {
                method: 'POST',
                body: JSON.stringify(payload)
            });

            // एप्लीकेशन फॉर्म जनरेट करना
            document.getElementById('pID').innerText = Math.floor(Math.random()*90000) + 10000;
            document.getElementById('pName').innerText = payload.StudentName;
            document.getElementById('pfName').innerText = payload.FatherName;
            document.getElementById('pCourse').innerText = payload.Course;
            document.getElementById('pMobile').innerText = payload.Mobile;
            document.getElementById('finalPhoto').src = document.getElementById('pPrev').src;
            document.getElementById('finalSign').src = document.getElementById('sPrev').src;

            document.getElementById('mainForm').style.display = 'none';
            document.getElementById('printArea').style.display = 'block';
            window.scrollTo(0,0);

        } catch (err) {
            console.error(err);
            alert("Error: Data could not be saved. Check Internet or Script Permissions.");
            btn.disabled = false;
            btn.innerText = "Try Again";
        }
    }
</script>

</body>
</html>