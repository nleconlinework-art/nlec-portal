<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Marksheet | NLEC India</title>
    <style>
        * { box-sizing: border-box; }
        body { font-family: 'Times New Roman', Times, serif; background: #f0f2f5; margin: 0; padding: 10px; display: flex; flex-direction: column; align-items: center; }
        
        .search-container { max-width: 500px; margin-bottom: 20px; background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); text-align: center; }
        input { padding: 10px; width: 60%; border: 1px solid #ddd; border-radius: 5px; }
        .view-btn { padding: 10px 20px; background: #003366; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }

        /* A4 Landscape Marksheet Fix */
        #marksheet-area { 
            display: none; 
            width: 297mm; 
            height: 210mm; 
            background: #fff; 
            padding: 8mm; 
            position: relative;
            box-shadow: 0 0 20px rgba(0,0,0,0.2);
            /* Background Watermark */
            background-image: linear-gradient(rgba(255,255,255,0.9), rgba(255,255,255,0.9)), url('ADCAMKL.PNG');
            background-position: center;
            background-repeat: no-repeat;
            background-size: 50% auto;
        }

        .golden-border {
            height: 100%;
            width: 100%;
            border: 10px double #003366;
            padding: 25px;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        /* Header Section */
        .m-header { text-align: center; border-bottom: 2px solid #ff6600; padding-bottom: 10px; }
        .inst-row { display: flex; align-items: center; justify-content: center; gap: 15px; }
        .inst-row img { height: 70px; }
        .inst-row h1 { color: #d32f2f; margin: 0; font-size: 34px; text-transform: uppercase; }

        .reg-text { font-size: 11px; color: #444; margin-top: 5px; font-weight: bold; }
        .govt-logos { margin-top: 8px; display: flex; gap: 8px; justify-content: center; }
        .govt-logos img { height: 32px; border: 1px solid #ddd; padding: 2px; background: white; }

        /* Student Info Grid */
        .student-info { 
            display: grid; 
            grid-template-columns: 1fr 1fr 1fr; 
            gap: 10px; 
            margin: 15px 0; 
            font-size: 14px; 
            text-align: left; 
            background: rgba(255,255,255,0.7); 
            padding: 10px;
            border: 1px solid #eee;
        }

        /* Professional Table */
        table { width: 100%; border-collapse: collapse; background: rgba(255,255,255,0.8); }
        th { background: #003366; color: white; padding: 8px; border: 1px solid #ddd; font-size: 14px; }
        td { padding: 8px; border: 1px solid #ddd; text-align: center; font-weight: bold; font-size: 14px; }
        .sub-name { text-align: left; padding-left: 15px; width: 40%; }

        /* Results & Total */
        .result-footer { display: flex; justify-content: space-between; align-items: center; margin-top: 15px; padding: 10px; background: #f9f9f9; border: 1px solid #ddd; }
        .total-box { font-size: 18px; font-weight: bold; color: #003366; }
        .status-pass { color: green; font-size: 20px; }

        .footer-signs { display: flex; justify-content: space-between; margin-top: 25px; }
        .sign-item { text-align: center; width: 200px; font-size: 14px; font-weight: bold; }
        .sign-item hr { border: 0; border-top: 1px solid #333; margin-bottom: 5px; }

        .print-btn { display: none; margin-top: 15px; padding: 12px 30px; background: #d32f2f; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }

        @media print {
            .search-container, .print-btn { display: none !important; }
            body { padding: 0; margin: 0; }
            #marksheet-area { display: block !important; width: 297mm; height: 210mm; box-shadow: none; }
            @page { size: landscape; margin: 0; }
        }
    </style>
</head>
<body>

<div class="search-container">
    <h2 style="color:#003366; margin:0 0 10px 0;">Verify Marksheet</h2>
    <input type="text" id="rollInput" placeholder="Enter Enrollment No.">
    <button class="view-btn" onclick="fetchMarksheet()">Search</button>
</div>

<div id="marksheet-area">
    <div class="golden-border">
        <div class="m-header">
            <div class="inst-row">
                <img src="logo.png" onerror="this.style.display='none'">
                <h1>Next Level Educational Council</h1>
            </div>
            <div class="reg-text">
                MCA Regd (U80902UP2022NPL173638) | MSME & Niti Aayog Registered | ISO 9001:2015 Certified
            </div>
            <div class="govt-logos">
                <img src="mca.png"><img src="niti.png"><img src="msme.png"><img src="skill.png"><img src="digital.png">
            </div>
            <h3 style="margin: 10px 0 0 0; color: #003366; text-decoration: underline;">STATEMENT OF MARKS</h3>
        </div>

        <div class="student-info">
            <div>Enrollment: <b id="d-enroll">--</b></div>
            <div>Name: <b id="d-name">--</b></div>
            <div>Father Name: <b id="d-fname">--</b></div>
            <div>DOB: <b id="d-dob">--</b></div>
            <div style="grid-column: span 2;">Course: <b id="d-course">--</b></div>
        </div>

        <table>
            <thead>
                <tr>
                    <th>Subject Description</th>
                    <th>Practical (50)</th>
                    <th>Theory (50)</th>
                    <th>Total Obtained (100)</th>
                </tr>
            </thead>
            <tbody id="marks-table">
                </tbody>
        </table>

        <div class="result-footer">
            <div class="total-box">Grand Total: <span id="d-total-num">--</span> / 500</div>
            <div id="d-total-words" style="font-style: italic; font-size: 13px;">--</div>
            <div class="status-pass" id="d-status">PASSED</div>
        </div>

        <div class="footer-signs">
            <div class="sign-item"><p>Date: 19/01/2026</p></div>
            <div class="sign-item"><hr><p>Controller of Examinations</p></div>
            <div class="sign-item"><hr><p>Authorized Signatory</p></div>
        </div>
    </div>
</div>

<button id="pBtn" class="print-btn" onclick="window.print()">Download Marksheet (Landscape)</button>

<script>
async function fetchMarksheet() {
    const roll = document.getElementById('rollInput').value.trim().toUpperCase();
    const sheetID = "168luhhOZR6zhAyYT7jEamuuexYgqhr5b731pFBF13DI";
    const url = `https://script.google.com/macros/s/AKfycbx_TuceJooaP8Iz1jTJ2lbM7MfIxKN556kPf8mYs_MbiFoJJ485yV0I6FMoP7sLQFcI/exec`;

    try {
        const resp = await fetch(url);
        const data = await resp.text();
        const rows = data.split('\n').map(r => r.split(','));
        const s = rows.find(r => r[0].trim().toUpperCase() === roll);

        if(s) {
            document.getElementById('marksheet-area').style.display = 'block';
            document.getElementById('pBtn').style.display = 'block';
            
            document.getElementById('d-enroll').innerText = s[0];
            document.getElementById('d-name').innerText   = s[1];
            document.getElementById('d-dob').innerText    = s[2];
            document.getElementById('d-fname').innerText  = s[3];
            document.getElementById('d-course').innerText = s[4];

            const modules = ["Computer Fundamental & OS", "MS Office Suite", "Tally Prime (Accounting)", "Web Technology & HTML", "Project & Viva-Voce"];
            let html = "";
            for(let i=0; i<5; i++) {
                let pr = s[5 + (i*2)] || "0";
                let th = s[6 + (i*2)] || "0";
                html += `<tr><td class="sub-name">${modules[i]}</td><td>${pr}</td><td>${th}</td><td>${parseInt(pr)+parseInt(th)}</td></tr>`;
            }
            document.getElementById('marks-table').innerHTML = html;
            document.getElementById('d-total-num').innerText = s[15];
            document.getElementById('d-total-words').innerText = "In Words: " + s[16];
        } else {
            alert("Enrollment No. Not Found!");
        }
    } catch(e) { alert("Network Error!"); }
}
</script>
</body>
</html>